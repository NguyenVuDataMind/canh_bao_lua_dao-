<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeNet Hub ¬∑ B·∫£o v·ªá b·∫°n kh·ªèi l·ª´a ƒë·∫£o</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #041b2f;
            --bg-gradient-start: #052640;
            --bg-gradient-end: #01212f;
            --primary: #00c16a;
            --secondary: #00b0ff;
            --accent: #ff695a;
            --text: #e4f1ff;
            --text-muted: rgba(228, 241, 255, 0.72);
            --card-bg: rgba(8, 27, 48, 0.8);
            --border: rgba(255, 255, 255, 0.08);
            --glass: rgba(255, 255, 255, 0.06);
            --shadow: 0 30px 60px rgba(0, 0, 0, 0.45);
            --radius-lg: 28px;
            --radius-md: 20px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Be Vietnam Pro', 'Segoe UI', Tahoma, sans-serif;
            background: radial-gradient(circle at 20% 20%, #07355c, #031525);
            color: var(--text);
            overflow-x: hidden;
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        .hub {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        header.hero {
            min-height: 100vh;
            padding: 32px clamp(20px, 4vw, 80px) 80px;
            background: radial-gradient(circle at top right, rgba(0, 177, 255, 0.35), transparent 35%),
                        radial-gradient(circle at 10% 20%, rgba(0, 193, 106, 0.35), transparent 30%),
                        linear-gradient(120deg, var(--bg-gradient-start), var(--bg-gradient-end));
            position: relative;
            overflow: hidden;
        }

        header.hero::after,
        header.hero::before {
            content: '';
            position: absolute;
            width: 320px;
            height: 320px;
            background: radial-gradient(circle, rgba(0, 177, 255, 0.6), transparent 65%);
            top: -120px;
            right: -80px;
            filter: blur(10px);
        }

        header.hero::before {
            width: 280px;
            height: 280px;
            top: auto;
            bottom: -140px;
            right: auto;
            left: -80px;
            background: radial-gradient(circle, rgba(0, 193, 106, 0.55), transparent 60%);
        }

        .nav-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 18px;
        }

        .brand {
            font-size: 26px;
            font-weight: 700;
            letter-spacing: 0.8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brand span {
            color: var(--primary);
        }

        nav.primary-nav {
            display: flex;
            gap: 28px;
            flex-wrap: wrap;
            font-weight: 500;
        }

        nav.primary-nav a {
            opacity: 0.78;
            transition: opacity 0.2s ease;
        }

        nav.primary-nav a:hover {
            opacity: 1;
        }

        .nav-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .chip {
            border-radius: 999px;
            padding: 10px 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.08);
            font-weight: 600;
            cursor: pointer;
            color: white;
            transition: transform 0.2s ease, background 0.2s ease;
        }

        .chip.primary {
            background: var(--primary);
            border-color: transparent;
            color: #042818;
        }

        .chip.secondary {
            background: linear-gradient(120deg, var(--secondary), #36d7ff);
            border-color: transparent;
            color: #00121f;
        }

        .chip.sos {
            background: linear-gradient(120deg, var(--accent), #ff9a7a);
            border-color: rgba(255, 255, 255, 0.15);
            color: #360101;
        }

        .chip:hover {
            transform: translateY(-2px);
        }

        .hero-body {
            display: flex;
            align-items: center;
            gap: clamp(30px, 5vw, 80px);
            margin-top: clamp(30px, 7vh, 80px);
            flex-wrap: wrap;
        }

        .hero-text {
            flex: 1;
            min-width: 280px;
        }

        .hero-title {
            font-size: clamp(40px, 7vw, 80px);
            line-height: 1.05;
            margin: 0;
            text-transform: uppercase;
        }

        .hero-title span {
            color: var(--primary);
        }

        .hero-description {
            margin-top: 20px;
            font-size: 18px;
            max-width: 480px;
            color: var(--text-muted);
        }

        .cta-form {
            margin-top: 32px;
            display: flex;
            gap: 12px;
            max-width: 560px;
            padding: 12px;
            border-radius: var(--radius-lg);
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
        }

        .cta-form input {
            flex: 1;
            padding: 18px 20px;
            border-radius: var(--radius-md);
            border: 0;
            background: rgba(0, 0, 0, 0.35);
            color: var(--text);
            font-size: 16px;
            outline: none;
        }

        .cta-form button {
            border: 0;
            background: linear-gradient(120deg, var(--primary), #02f28b);
            color: #01301c;
            font-weight: 700;
            padding: 0 28px;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .cta-form button:hover {
            transform: translateY(-2px);
        }

        .hero-visual {
            flex: 1;
            min-width: 280px;
            display: flex;
            justify-content: center;
        }

        .orb {
            width: clamp(260px, 45vw, 420px);
            aspect-ratio: 1;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2), transparent 55%),
                        radial-gradient(circle at 30% 30%, #06263c, #01111e 65%);
            border: 1px solid rgba(255, 255, 255, 0.12);
            position: relative;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.35), inset 0 0 80px rgba(0, 193, 106, 0.4);
            animation: float 6s infinite ease-in-out;
        }

        .orb::before,
        .orb::after {
            content: '';
            position: absolute;
            border-radius: 50%;
        }

        .orb::before {
            width: 60%;
            height: 60%;
            top: 20%;
            left: 20%;
            background: rgba(0, 193, 106, 0.2);
            filter: blur(6px);
        }

        .orb::after {
            width: 30%;
            height: 30%;
            right: 10%;
            top: 10%;
            background: rgba(255, 255, 255, 0.25);
            filter: blur(4px);
        }

        @keyframes float {
            0%,100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        main {
            background: linear-gradient(180deg, rgba(2, 10, 22, 0.95), rgba(1, 8, 18, 0.95));
            padding: clamp(32px, 6vw, 80px);
        }

        .section {
            margin-bottom: 80px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 24px;
        }

        .section-header h2 {
            margin: 0;
            font-size: 32px;
        }

        .lookup-result {
            margin-top: 18px;
            background: linear-gradient(120deg, rgba(0, 193, 106, 0.12), rgba(0, 118, 255, 0.12));
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: var(--radius-md);
            padding: 20px 24px;
            display: none;
        }

        .lookup-result.visible {
            display: block;
        }

        .lookup-result h4 {
            margin: 0;
            font-size: 18px;
        }

        .lookup-result h4.safe {
            color: var(--primary);
        }
        
        .lookup-result h4.danger {
            color: var(--accent);
        }
        
        .lookup-result h4.warning {
            color: #ffa726;
        }

        .lookup-result p {
            margin: 6px 0 0;
            color: var(--text-muted);
        }
        
        .admin-btn {
            background: rgba(255, 105, 90, 0.2) !important;
            border: 1px solid rgba(255, 105, 90, 0.4) !important;
            color: var(--accent) !important;
            pointer-events: auto !important;
            cursor: pointer !important;
        }
        
        .admin-btn:hover {
            background: rgba(255, 105, 90, 0.3) !important;
        }
        
        .admin-btn:active {
            transform: translateY(0) !important;
        }

        /* AI Chat Box Popup */
        .ai-chat-box {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 420px;
            max-height: 600px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            z-index: 10000;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .ai-chat-box.active {
            display: flex;
        }

        .ai-chat-header {
            background: linear-gradient(120deg, var(--primary), var(--secondary));
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--border);
        }

        .ai-chat-header img {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00c16a, #00b0ff);
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0, 193, 106, 0.3);
        }

        .ai-chat-header h3 {
            margin: 0;
            flex: 1;
            font-size: 18px;
        }

        .ai-chat-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-chat-body {
            padding: 20px;
            flex: 1;
            overflow-y: auto;
        }

        .ai-chat-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .ai-chat-tab {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            cursor: pointer;
            text-align: center;
            font-size: 14px;
            transition: all 0.3s;
        }

        .ai-chat-tab.active {
            background: var(--primary);
            color: #042818;
            border-color: var(--primary);
        }

        .ai-upload-area {
            border: 2px dashed var(--border);
            border-radius: var(--radius-md);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.02);
            margin-bottom: 16px;
        }

        .ai-upload-area:hover {
            border-color: var(--primary);
            background: rgba(0, 193, 106, 0.1);
        }

        .ai-upload-area.has-image {
            border-color: var(--primary);
            background: rgba(0, 193, 106, 0.1);
        }

        .ai-upload-icon {
            font-size: 64px;
            margin-bottom: 16px;
            filter: drop-shadow(0 4px 8px rgba(0, 193, 106, 0.3));
        }

        .ai-upload-text {
            color: var(--text);
            font-size: 15px;
            line-height: 1.6;
        }
        
        .ai-upload-text strong {
            color: var(--primary);
            font-weight: 600;
        }

        .ai-image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 12px;
        }

        .ai-text-input {
            width: 100%;
            min-height: 140px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            color: var(--text);
            font-family: inherit;
            font-size: 15px;
            resize: vertical;
            margin-bottom: 16px;
            transition: all 0.3s;
        }

        .ai-text-input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 0 3px rgba(0, 193, 106, 0.1);
        }
        
        .ai-text-input::placeholder {
            color: var(--text-muted);
        }

        .ai-chat-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .ai-submit-btn {
            flex: 1;
            padding: 12px;
            background: var(--primary);
            color: #042818;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ai-submit-btn:hover {
            background: #00d97a;
            transform: translateY(-2px);
        }

        .ai-reset-btn {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .ai-reset-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .ai-result {
            margin-top: 20px;
            padding: 16px;
            background: rgba(0, 193, 106, 0.1);
            border: 1px solid var(--primary);
            border-radius: var(--radius-md);
            display: none;
        }

        .ai-result.visible {
            display: block;
        }

        .ai-result h4 {
            margin: 0 0 12px;
            color: var(--primary);
        }

        .ai-result p {
            margin: 8px 0;
            color: var(--text);
            font-size: 14px;
        }

        .auth-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.65);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 12000;
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-card {
            width: min(420px, 90vw);
            background: rgba(3, 12, 24, 0.95);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            padding: 28px;
            color: var(--text);
            position: relative;
        }

        .auth-close {
            position: absolute;
            top: 16px;
            right: 16px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
        }

        .auth-tabs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .auth-tab {
            padding: 10px;
            border-radius: 14px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.04);
            cursor: pointer;
            text-align: center;
            font-weight: 600;
        }

        .auth-tab.active {
            background: var(--primary);
            color: #042818;
            border-color: transparent;
        }

        .auth-form {
            display: none;
            flex-direction: column;
            gap: 16px;
        }

        .auth-form.active {
            display: flex;
        }

        .auth-form label {
            font-size: 14px;
            color: var(--text-muted);
        }

        .auth-form input {
            width: 100%;
            padding: 12px 14px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.04);
            color: var(--text);
        }

        .auth-form button {
            padding: 14px;
            border-radius: 14px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            background: linear-gradient(120deg, var(--primary), #03e37f);
            color: #022518;
        }

        .auth-status {
            margin-top: 8px;
            font-size: 14px;
            border-radius: 12px;
            padding: 10px 14px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            display: none;
        }

        .auth-status.visible {
            display: block;
        }

        .auth-status.success {
            border-color: rgba(14, 210, 144, 0.8);
            color: #0ed290;
        }

        .auth-status.error {
            border-color: rgba(255, 112, 112, 0.8);
            color: #ff8b8b;
        }

        .panel-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: clamp(20px, 3vw, 36px);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }

        .ai-grid,
        .report-grid {
            display: grid;
            gap: 16px;
        }

        .input-note {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        .hidden {
            display: none !important;
        }

        #lessons {
            text-align: center;
        }

        .lesson-shell {
            background: rgba(8, 27, 48, 0.9);
            border-radius: var(--radius-lg);
            padding: clamp(24px, 4vw, 48px);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            margin: 0 auto;
            max-width: 1100px;
            text-align: left;
        }

        .category-tabs {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 24px;
            justify-content: center;
        }

        .category-tab {
            border-radius: 18px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .category-tab span {
            font-size: 12px;
            color: var(--text-muted);
            letter-spacing: 0.4px;
        }

        .category-tab.active {
            background: linear-gradient(120deg, var(--primary), #26ffbf);
            color: #001d11;
            border-color: transparent;
        }

        .lesson-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
            justify-items: center;
        }

        .lesson-card {
            background: rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-md);
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: transform 0.2s ease, border 0.2s ease;
        }

        .lesson-card.active {
            border-color: var(--primary);
            transform: translateY(-4px);
        }

        .lesson-status {
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            color: var(--text-muted);
        }

        .lesson-card h4 {
            margin: 8px 0 0;
        }

        .lesson-detail {
            margin-top: 32px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--radius-md);
            padding: clamp(18px, 3vw, 36px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .lesson-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
            gap: 16px;
        }

        .lesson-header h3 {
            margin: 0;
            font-size: 26px;
        }

        .lesson-tag {
            padding: 10px 20px;
            border-radius: 999px;
            background: rgba(0, 193, 106, 0.15);
            border: 1px solid rgba(0, 193, 106, 0.4);
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .lesson-summary {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            padding: 20px;
            line-height: 1.6;
            color: var(--text-muted);
        }

        .coming-soon {
            text-align: center;
            padding: 80px 20px;
            background: rgba(4, 20, 38, 0.7);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .coming-soon h3 {
            margin-top: 0;
        }

        .lesson-media {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            align-items: stretch;
        }

        .video-panel {
            position: relative;
            border-radius: 24px;
            overflow: hidden;
            background: radial-gradient(circle, rgba(0, 177, 255, 0.18), rgba(0, 9, 20, 0.8));
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-height: 0;
            aspect-ratio: 16 / 9;
        }

        .video-panel iframe {
            width: 100%;
            height: 100%;
        }

        .video-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 14px;
            background: rgba(1, 9, 18, 0.7);
            text-align: center;
        }

        .video-overlay button {
            width: 82px;
            height: 82px;
            border-radius: 50%;
            border: 0;
            font-size: 30px;
            background: white;
            color: #062021;
            cursor: pointer;
        }

        .knowledge-panel {
            background: rgba(4, 20, 38, 0.85);
            border-radius: 24px;
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .risk-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .risk-tab {
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 10px 18px;
            font-weight: 600;
            cursor: pointer;
        }

        .risk-tab.active {
            background: var(--secondary);
            color: #00142a;
            border-color: transparent;
        }

        .risk-card {
            position: relative;
            border-radius: 20px;
            padding: 32px;
            background: radial-gradient(circle at top left, rgba(0, 176, 255, 0.15), rgba(255, 255, 255, 0.02));
            border: 1px solid rgba(255, 255, 255, 0.08);
            min-height: 220px;
            cursor: pointer;
            overflow: hidden;
        }

        .risk-icon {
            width: 64px;
            height: 64px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            margin-bottom: 18px;
        }

        .risk-title {
            font-size: 24px;
            margin: 0 0 12px;
        }

        .risk-meta {
            font-size: 13px;
            letter-spacing: 0.4px;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        .risk-content {
            font-size: 17px;
            line-height: 1.7;
        }

        .quiz-card {
            background: rgba(3, 12, 24, 0.85);
            border-radius: 24px;
            padding: clamp(20px, 3vw, 36px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .question-steps {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .quiz-card h3 {
            margin-top: 0;
            font-size: 22px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .quiz-option {
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            padding: 18px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.02);
            display: flex;
            gap: 12px;
            align-items: center;
            font-size: 16px;
            color: var(--text);
        }

        .quiz-option.correct {
            border-color: #0ed290;
            background: rgba(14, 210, 144, 0.12);
        }

        .quiz-option.incorrect {
            border-color: #ff7070;
            background: rgba(255, 112, 112, 0.12);
        }

        .badge {
            width: 32px;
            height: 32px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.16);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.05);
        }

        footer {
            padding: 40px clamp(24px, 5vw, 80px);
            text-align: center;
            color: var(--text-muted);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            background: #030d18;
        }

        .tabs {
            display: inline-flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 999px;
            padding: 4px;
            margin-bottom: 20px;
        }

        .tab {
            border: 0;
            border-radius: 999px;
            padding: 10px 18px;
            cursor: pointer;
            background: transparent;
            color: white;
            font-weight: 600;
        }

        .tab.active {
            background: var(--primary);
            color: #012013;
        }

        .form-grid {
            display: grid;
            gap: 16px;
        }

        .form-grid input,
        .form-grid textarea,
        .form-grid select {
            width: 100%;
            padding: 14px 16px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.04);
            color: white;
            font-size: 15px;
        }

        .form-grid textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-grid label {
            font-size: 14px;
            color: var(--text-muted);
        }

        .submit-btn {
            margin-top: 12px;
            padding: 16px 24px;
            border-radius: var(--radius-md);
            border: 0;
            font-weight: 600;
            cursor: pointer;
            background: linear-gradient(120deg, var(--primary), #03e37f);
            color: #022518;
        }

        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            margin-top: 8px;
        }

        .status-pill.success {
            color: #0ed290;
        }

        .status-pill.error {
            color: #ff8b8b;
        }

        /* Auth Gate Styles */
        .auth-gate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 20%, #07355c, #031525);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .auth-gate-content {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 48px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            max-width: 480px;
            width: 90%;
            text-align: center;
        }

        .brand-large {
            font-size: 36px;
            font-weight: 700;
            letter-spacing: 0.8px;
            margin-bottom: 16px;
        }

        .brand-large span {
            color: var(--primary);
        }

        .auth-gate-subtitle {
            font-size: 18px;
            color: var(--text-muted);
            margin: 0 0 8px;
        }

        .auth-gate-description {
            color: var(--text-muted);
            margin: 0 0 32px;
            font-size: 14px;
        }

        .auth-gate-tabs {
            display: flex;
            gap: 8px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 24px;
        }

        .auth-gate-tab {
            flex: 1;
            padding: 12px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .auth-gate-tab.active {
            background: var(--primary);
            color: #042818;
        }

        .auth-gate-form {
            display: none;
            gap: 16px;
            flex-direction: column;
        }

        .auth-gate-form.active {
            display: flex;
        }

        .auth-gate-form input {
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }

        .auth-gate-form input:focus {
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.08);
        }

        .auth-gate-form button {
            padding: 16px;
            background: var(--primary);
            color: #042818;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-gate-form button:hover {
            background: #00d97a;
            transform: translateY(-2px);
        }

        .auth-gate-status {
            margin: 16px 0;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            display: none;
        }

        .auth-gate-status.visible {
            display: block;
        }

        .auth-gate-status.success {
            background: rgba(0, 193, 106, 0.15);
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .auth-gate-status.error {
            background: rgba(255, 105, 90, 0.15);
            border: 1px solid var(--accent);
            color: var(--accent);
        }

        @media (max-width: 900px) {
            nav.primary-nav {
                display: none;
            }
            .hero-body {
                flex-direction: column;
            }
            .cta-form {
                flex-direction: column;
            }
            .cta-form button {
                width: 100%;
                padding: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Auth Gate - shown first -->
    <div class="auth-gate" id="authGate">
        <div class="auth-gate-content">
            <div class="brand-large">Safe<span>Net</span> Hub</div>
            <p class="auth-gate-subtitle">B·∫£o v·ªá b·∫°n kh·ªèi l·ª´a ƒë·∫£o tr·ª±c tuy·∫øn</p>
            <p class="auth-gate-description">Vui l√≤ng ƒëƒÉng nh·∫≠p ho·∫∑c t·∫°o t√†i kho·∫£n ƒë·ªÉ s·ª≠ d·ª•ng SafeNet Hub</p>
            
            <div class="auth-gate-tabs">
                <button class="auth-gate-tab active" data-gate-tab="login">ƒêƒÉng nh·∫≠p</button>
                <button class="auth-gate-tab" data-gate-tab="register">ƒêƒÉng k√Ω</button>
            </div>

            <div class="auth-gate-status" id="authGateStatus"></div>

            <form class="auth-gate-form active" id="gateLoginForm">
                <input type="email" id="gateLoginEmail" required placeholder="Email c·ªßa b·∫°n" />
                <input type="password" id="gateLoginPassword" required placeholder="M·∫≠t kh·∫©u" />
                <button type="submit">ƒêƒÉng nh·∫≠p</button>
            </form>

            <form class="auth-gate-form" id="gateRegisterForm">
                <input type="email" id="gateRegisterEmail" required placeholder="Email c·ªßa b·∫°n" />
                <input type="password" id="gateRegisterPassword" required placeholder="M·∫≠t kh·∫©u (t·ªëi thi·ªÉu 8 k√Ω t·ª±)" />
                <input type="text" id="gateRegisterName" placeholder="H·ªç t√™n (t√πy ch·ªçn)" />
                <button type="submit">T·∫°o t√†i kho·∫£n</button>
            </form>

            <form class="auth-gate-form" id="gateOtpForm" style="display: none;">
                <p>Ch√∫ng t√¥i ƒë√£ g·ª≠i m√£ OTP ƒë·∫øn email c·ªßa b·∫°n</p>
                <input type="email" id="gateOtpEmail" required placeholder="Email ƒë√£ ƒëƒÉng k√Ω" />
                <input type="text" id="gateOtpCode" required placeholder="Nh·∫≠p m√£ OTP (6 s·ªë)" maxlength="6" />
                <button type="submit">X√°c minh</button>
            </form>
        </div>
    </div>

    <div class="hub" id="mainApp" style="display: none;">
        <header class="hero" id="home">
            <div class="nav-bar">
                <div class="brand">Safe<span>Net</span></div>
                <nav class="primary-nav">
                    <a href="/index.html">Trang ch·ªß</a>
                    <a href="/lessons.html">B√†i h·ªçc</a>
                    <a href="#" id="newsLink" title="T√≠nh nƒÉng s·∫Ω s·ªõm ƒë∆∞·ª£c ph√°t tri·ªÉn">Tin t·ª©c</a>
                    <a href="/index.html#about">ƒê·ªëi t√°c</a>
                </nav>
                <div class="nav-actions">
                    <a href="/report.html" class="chip" style="text-decoration: none; display: inline-block;">B√°o c√°o</a>
                    <button type="button" class="chip primary" id="aiBtn">AI t∆∞ v·∫•n</button>
                    <button type="button" class="chip sos" id="sosBtn" title="Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn">SOS c·∫ßu c·ª©u</button>
                    <button type="button" class="chip secondary" id="logoutBtn" style="display: none;">ƒêƒÉng xu·∫•t</button>
                    <a href="/admin.html" class="chip admin-btn" style="text-decoration: none; display: inline-block; position: relative; z-index: 1000; pointer-events: auto !important; cursor: pointer !important;">Admin</a>
                </div>
            </div>

            <div class="hero-body">
                <div class="hero-text">
                    <p style="letter-spacing: 0.3em; text-transform: uppercase; color: var(--text-muted); margin: 0;">
                        SafeNet Hub
                    </p>
                    <h1 class="hero-title">B·∫°n c√≥ ƒëang l∆∞·ªõt m·∫°ng <span>an to√†n?</span></h1>
                    <p class="hero-description">
                        Nh·∫≠p ƒë∆∞·ªùng d·∫´n ho·∫∑c s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ ki·ªÉm tra t·ª©c th√¨, tr√≤ chuy·ªán c√πng AI ƒë·ªÉ ph√¢n t√≠ch ·∫£nh/tin nh·∫Øn,
                        v√† h·ªçc c√°c k·ªπ nƒÉng ph√≤ng ch·ªëng l·ª´a ƒë·∫£o ngay tr√™n m·ªôt giao di·ªán duy nh·∫•t.
                    </p>
                    <form class="cta-form" id="lookupForm">
                        <input type="text" id="lookupInput" placeholder="Nh·∫≠p URL ho·∫∑c s·ªë ƒëi·ªán tho·∫°i" />
                        <button type="submit">Tra c·ª©u ngay</button>
                    </form>
                    <div class="lookup-result" id="lookupResult">
                        <h4>K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y.</h4>
                        <p>V√≠ d·ª•: nh·∫≠p <code>https://example.com</code> ho·∫∑c <code>0912345678</code>.</p>
                    </div>
                </div>
                <div class="hero-visual">
                    <div class="orb"></div>
                </div>
            </div>
        </header>

        <main>

            <section class="section" id="about">
                <div class="section-header">
                    <div>
                        <p style="text-transform: uppercase; letter-spacing: 0.4em; color: var(--text-muted); margin: 0;">K·∫øt n·ªëi</p>
                        <h2>ƒê·ªëi t√°c & truy·ªÅn th√¥ng</h2>
                    </div>
                </div>
                <p style="max-width: 640px; color: var(--text-muted);">
                    SafeNet h·ª£p t√°c c√πng c√°c t·ªï ch·ª©c gi√°o d·ª•c, ng√¢n h√†ng v√† c√¥ng ty vi·ªÖn th√¥ng ƒë·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu l·ª´a ƒë·∫£o m·ªõi nh·∫•t.
                    H√£y li√™n h·ªá ch√∫ng t√¥i n·∫øu b·∫°n mu·ªën mang ch∆∞∆°ng tr√¨nh n√†y t·ªõi tr∆∞·ªùng h·ªçc ho·∫∑c doanh nghi·ªáp.
                </p>
            </section>
        </main>

        <footer id="footer">
            ¬© <span id="year"></span> SafeNet ¬∑ B·∫£o v·ªá b·∫°n kh·ªèi nh·ªØng chi√™u tr√≤ l·ª´a ƒë·∫£o.
        </footer>
    </div>

    <div class="auth-modal" id="authModal">
        <div class="auth-card">
            <button class="auth-close" id="authClose">√ó</button>
            <div class="auth-tabs">
                <button class="auth-tab active" data-auth-tab="register">ƒêƒÉng k√Ω</button>
                <button class="auth-tab" data-auth-tab="otp">X√°c minh OTP</button>
                <button class="auth-tab" data-auth-tab="login">ƒêƒÉng nh·∫≠p</button>
            </div>

            <div class="auth-status" id="authStatus"></div>

            <form class="auth-form active" id="registerForm">
                <div>
                    <label for="registerEmail">Email *</label>
                    <input type="email" id="registerEmail" required placeholder="you@example.com" />
                </div>
                <div>
                    <label for="registerPassword">M·∫≠t kh·∫©u *</label>
                    <input type="password" id="registerPassword" required placeholder="T·ªëi thi·ªÉu 8 k√Ω t·ª±" />
                </div>
                <div>
                    <label for="registerPhone">S·ªë ƒëi·ªán tho·∫°i (t√πy ch·ªçn)</label>
                    <input type="tel" id="registerPhone" placeholder="+84901234567" />
                </div>
                <div>
                    <label for="registerName">H·ªç t√™n (t√πy ch·ªçn)</label>
                    <input type="text" id="registerName" placeholder="Nguy·ªÖn VƒÉn A" />
                </div>
                <button type="submit">T·∫°o t√†i kho·∫£n</button>
            </form>

            <form class="auth-form" id="otpForm">
                <div>
                    <label for="otpEmail">Email ƒë√£ ƒëƒÉng k√Ω *</label>
                    <input type="email" id="otpEmail" required placeholder="you@example.com" />
                </div>
                <div>
                    <label for="otpCode">M√£ OTP *</label>
                    <input type="text" id="otpCode" required placeholder="Nh·∫≠p 6 s·ªë" maxlength="6" />
                </div>
                <button type="submit">X√°c minh OTP</button>
            </form>

            <form class="auth-form" id="loginForm">
                <div>
                    <label for="loginEmail">Email *</label>
                    <input type="email" id="loginEmail" required placeholder="you@example.com" />
                </div>
                <div>
                    <label for="loginPassword">M·∫≠t kh·∫©u *</label>
                    <input type="password" id="loginPassword" required placeholder="********" />
                </div>
                <button type="submit">ƒêƒÉng nh·∫≠p</button>
            </form>
        </div>
    </div>

    <!-- AI Chat Box Popup -->
    <div class="ai-chat-box" id="aiChatBox">
        <div class="ai-chat-header">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z'/%3E%3C/svg%3E" alt="AI" style="filter: brightness(0) invert(1);" />
            <h3>ü§ñ AI T∆∞ v·∫•n</h3>
            <button class="ai-chat-close" id="aiChatClose">√ó</button>
        </div>
        <div class="ai-chat-body">
            <div class="ai-chat-tabs">
                <button class="ai-chat-tab active" data-ai-mode="image">üì∑ ·∫¢nh</button>
                <button class="ai-chat-tab" data-ai-mode="text">‚úçÔ∏è VƒÉn b·∫£n</button>
            </div>
            
            <div id="aiImageMode">
                <div class="ai-upload-area" id="aiUploadArea">
                    <div class="ai-upload-icon">üì§</div>
                    <div class="ai-upload-text">
                        <strong>Ch·ªçn ho·∫∑c k√©o th·∫£ ·∫£nh v√†o ƒë√¢y</strong><br>
                        H·ªó tr·ª£ JPG, PNG, HEIC. Dung l∆∞·ª£ng &lt; 5MB
                    </div>
                    <input type="file" id="aiImageInput" accept="image/*" style="display: none;" />
                    <img id="aiImagePreview" class="ai-image-preview" style="display: none;" />
                </div>
            </div>
            
            <div id="aiTextMode" style="display: none;">
                <textarea class="ai-text-input" id="aiTextInput" placeholder="Nh·∫≠p n·ªôi dung tin nh·∫Øn ho·∫∑c vƒÉn b·∫£n c·∫ßn ph√¢n t√≠ch...&#10;&#10;V√≠ d·ª•: 'Ng√¢n h√†ng th√¥ng b√°o t√†i kho·∫£n c·ªßa b·∫°n b·ªã kh√≥a, h√£y chuy·ªÉn kho·∫£n 10 tri·ªáu ƒë·ªÉ m·ªü kh√≥a...'"></textarea>
            </div>
            
            <div class="ai-chat-actions">
                <button class="ai-submit-btn" id="aiSubmit">G·ª≠i t·ªõi AI</button>
                <button class="ai-reset-btn" id="aiReset">üîÑ L√†m m·ªõi</button>
            </div>
            
            <div class="ai-result" id="aiResult"></div>
        </div>
    </div>

    <script>
        // Navigation ƒë√£ ƒë∆∞·ª£c chuy·ªÉn sang chuy·ªÉn trang thay v√¨ scroll
        // T·∫•t c·∫£ links ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t ƒë·ªÉ s·ª≠ d·ª•ng href thay v√¨ data-scroll
        
        // N√∫t SOS - L·∫•y v·ªã tr√≠ v√† g·ª≠i request
        const sosBtn = document.getElementById('sosBtn');
        if (sosBtn) {
            sosBtn.addEventListener('click', async (event) => {
                event.preventDefault();
                event.stopPropagation();
                
                // X√°c nh·∫≠n tr∆∞·ªõc khi g·ª≠i
                if (!confirm('üö® B·∫°n c√≥ ch·∫Øc mu·ªën g·ª≠i t√≠n hi·ªáu SOS c·∫ßu c·ª©u?\n\nV·ªã tr√≠ c·ªßa b·∫°n s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn admin ngay l·∫≠p t·ª©c.')) {
                    return;
                }
                
                const originalText = sosBtn.textContent;
                sosBtn.disabled = true;
                sosBtn.textContent = '‚è≥ ƒêang l·∫•y v·ªã tr√≠...';
                
                try {
                    // L·∫•y v·ªã tr√≠ GPS
                    const position = await new Promise((resolve, reject) => {
                        if (!navigator.geolocation) {
                            reject(new Error('Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ GPS'));
                            return;
                        }
                        
                        navigator.geolocation.getCurrentPosition(
                            resolve,
                            reject,
                            {
                                enableHighAccuracy: true,
                                timeout: 10000,
                                maximumAge: 0
                            }
                        );
                    });
                    
                    const { latitude, longitude, accuracy } = position.coords;
                    
                    sosBtn.textContent = 'üì§ ƒêang g·ª≠i...';
                    
                    // G·ª≠i request l√™n server
                    const token = localStorage.getItem('access_token');
                    if (!token) {
                        throw new Error('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ s·ª≠ d·ª•ng ch·ª©c nƒÉng SOS');
                    }

                    const response = await fetch('/api/v1/sos', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`,
                        },
                        body: JSON.stringify({
                            latitude,
                            longitude,
                            accuracy
                        }),
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({}));
                        throw new Error(errorData.detail || 'Kh√¥ng th·ªÉ g·ª≠i SOS request');
                    }
                    
                    const data = await response.json();
                    
                    alert('‚úÖ ƒê√£ g·ª≠i t√≠n hi·ªáu SOS th√†nh c√¥ng!\n\nAdmin s·∫Ω ƒë∆∞·ª£c th√¥ng b√°o ngay l·∫≠p t·ª©c qua email.\nV·ªã tr√≠ c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n.');
                    sosBtn.textContent = originalText;
                    sosBtn.disabled = false;
                    
                } catch (error) {
                    console.error('SOS Error:', error);
                    
                    let errorMessage = '‚ùå L·ªói: ';
                    if (error.message.includes('permission') || error.message.includes('denied')) {
                        errorMessage = '‚ö†Ô∏è C·∫ßn quy·ªÅn truy c·∫≠p v·ªã tr√≠ ƒë·ªÉ g·ª≠i SOS.\n\nVui l√≤ng:\n1. Cho ph√©p truy c·∫≠p v·ªã tr√≠ trong c√†i ƒë·∫∑t tr√¨nh duy·ªát\n2. Refresh trang v√† th·ª≠ l·∫°i';
                    } else if (error.message.includes('timeout')) {
                        errorMessage = '‚ö†Ô∏è Kh√¥ng th·ªÉ l·∫•y v·ªã tr√≠ (timeout).\n\nVui l√≤ng ki·ªÉm tra:\n- GPS ƒë√£ b·∫≠t ch∆∞a\n- K·∫øt n·ªëi internet\n- Th·ª≠ l·∫°i sau';
                    } else if (error.message.includes('not available')) {
                        errorMessage = '‚ö†Ô∏è V·ªã tr√≠ kh√¥ng kh·∫£ d·ª•ng.\n\nVui l√≤ng th·ª≠ l·∫°i sau ho·∫∑c ki·ªÉm tra c√†i ƒë·∫∑t GPS.';
                    } else {
                        errorMessage += error.message;
                    }
                    
                    alert(errorMessage);
                    sosBtn.textContent = originalText;
                    sosBtn.disabled = false;
                }
            });
        }
        
        // ƒê·∫£m b·∫£o n√∫t Admin ho·∫°t ƒë·ªông
        const adminLink = document.querySelector('a.admin-btn');
        if (adminLink) {
            adminLink.addEventListener('click', (e) => {
                // Kh√¥ng preventDefault ƒë·ªÉ link ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng
                e.stopPropagation();
                // ƒê·∫£m b·∫£o link ƒë∆∞·ª£c navigate
                window.location.href = '/admin.html';
            });
        }

        // Lookup form logic
        const lookupForm = document.getElementById('lookupForm');
        const lookupInput = document.getElementById('lookupInput');
        const lookupResult = document.getElementById('lookupResult');

        const isUrl = (value) => /https?:\/\//i.test(value) || value.includes('.');

        lookupForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            const value = lookupInput.value.trim();
            if (!value) return;
            lookupResult.classList.add('visible');
            lookupResult.innerHTML = '<h4>ƒêang ki·ªÉm tra ...</h4>';

            try {
                if (isUrl(value)) {
                    const response = await fetch('/api/v1/whitelist/check', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ urls: [value] }),
                    });
                    if (!response.ok) throw new Error('Kh√¥ng th·ªÉ ki·ªÉm tra URL');
                    const data = await response.json();
                    const result = data.results[0];
                    
                    let icon = '';
                    let statusClass = '';
                    if (result.match_type === 'whitelist') {
                        icon = '‚úÖ';
                        statusClass = 'safe';
                    } else if (result.match_type === 'blacklist') {
                        icon = '‚ö†Ô∏è';
                        statusClass = 'danger';
                    } else {
                        icon = '‚ö†Ô∏è';
                        statusClass = 'warning';
                    }
                    
                    lookupResult.innerHTML = `
                        <h4 class="${statusClass}">${icon} ${result.reason || 'K·∫øt qu·∫£ ki·ªÉm tra'}</h4>
                        <p>URL: ${result.original_url}</p>
                    `;
                } else {
                    const response = await fetch('/api/v1/reported_phones/search?value=' + encodeURIComponent(value));
                    if (!response.ok) throw new Error('Kh√¥ng th·ªÉ ki·ªÉm tra SƒêT');
                    const data = await response.json();
                    
                    let icon = '';
                    let statusClass = '';
                    if (data.found) {
                        icon = '‚ö†Ô∏è';
                        statusClass = 'danger';
                    } else {
                        icon = '';
                        statusClass = 'safe';
                        lookupResult.innerHTML = `
                            <h4 class="${statusClass}">
                                S·ªë ƒëi·ªán tho·∫°i n√†y ch∆∞a c√≥ trong h·ªá th·ªëng nh∆∞ng v·∫´n c√≥ th·ªÉ l√† s·ªë ƒëi·ªán tho·∫°i l·ª´a ƒë·∫£o.
                                H√£y c·∫©n th·∫≠n v√† ti·∫øp t·ª•c theo d√µi b·∫±ng ch·ª©c nƒÉng tr√≤ chuy·ªán AI.
                            </h4>
                        `;
                        return;
                    }
                }
            } catch (error) {
                lookupResult.innerHTML = `<h4>ƒê√£ x·∫£y ra l·ªói</h4><p>${error.message}</p>`;
            }
        });

        // Lessons moved to lessons.html

        // AI Chat Box Popup
        const aiBtn = document.getElementById('aiBtn');
        const aiChatBox = document.getElementById('aiChatBox');
        const aiChatClose = document.getElementById('aiChatClose');
        const aiChatTabs = document.querySelectorAll('.ai-chat-tab');
        const aiImageInput = document.getElementById('aiImageInput');
        const aiTextInput = document.getElementById('aiTextInput');
        const aiResult = document.getElementById('aiResult');
        const aiUploadArea = document.getElementById('aiUploadArea');
        const aiImagePreview = document.getElementById('aiImagePreview');
        const aiImageMode = document.getElementById('aiImageMode');
        const aiTextMode = document.getElementById('aiTextMode');
        const aiSubmit = document.getElementById('aiSubmit');
        const aiReset = document.getElementById('aiReset');
        let aiMode = 'image';

        // M·ªü/ƒë√≥ng AI chat box
        if (aiBtn) {
            aiBtn.addEventListener('click', () => {
                aiChatBox.classList.add('active');
            });
        }

        if (aiChatClose) {
            aiChatClose.addEventListener('click', () => {
                aiChatBox.classList.remove('active');
            });
        }

        // Chuy·ªÉn tab AI
        aiChatTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                aiMode = tab.dataset.aiMode;
                aiChatTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                if (aiMode === 'image') {
                    aiImageMode.style.display = 'block';
                    aiTextMode.style.display = 'none';
                } else {
                    aiImageMode.style.display = 'none';
                    aiTextMode.style.display = 'block';
                }
            });
        });

        // Upload ·∫£nh
        if (aiUploadArea) {
            aiUploadArea.addEventListener('click', () => {
                aiImageInput.click();
            });

            aiUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                aiUploadArea.classList.add('has-image');
            });

            aiUploadArea.addEventListener('dragleave', () => {
                aiUploadArea.classList.remove('has-image');
            });

            aiUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                aiUploadArea.classList.remove('has-image');
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    handleImageSelect(file);
                }
            });
        }

        if (aiImageInput) {
            aiImageInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    handleImageSelect(file);
                }
            });
        }

        function handleImageSelect(file) {
            if (file.size > 5 * 1024 * 1024) {
                alert('·∫¢nh qu√° l·ªõn! Vui l√≤ng ch·ªçn ·∫£nh nh·ªè h∆°n 5MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                aiImagePreview.src = e.target.result;
                aiImagePreview.style.display = 'block';
                aiUploadArea.classList.add('has-image');
                aiUploadArea.querySelector('.ai-upload-text').innerHTML = `
                    <strong>${file.name}</strong><br>
                    ${(file.size / 1024).toFixed(1)} KB
                `;
            };
            reader.readAsDataURL(file);
        }

        // Reset cu·ªôc tr√≤ chuy·ªán
        if (aiReset) {
            aiReset.addEventListener('click', () => {
                if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën l√†m m·ªõi cu·ªôc tr√≤ chuy·ªán? T·∫•t c·∫£ d·ªØ li·ªáu s·∫Ω b·ªã x√≥a.')) {
                    aiImageInput.value = '';
                    aiTextInput.value = '';
                    aiImagePreview.style.display = 'none';
                    aiResult.classList.remove('visible');
                    aiResult.innerHTML = '';
                    aiUploadArea.classList.remove('has-image');
                    aiUploadArea.querySelector('.ai-upload-text').innerHTML = `
                        <strong>Ch·ªçn ho·∫∑c k√©o th·∫£ ·∫£nh v√†o ƒë√¢y</strong><br>
                        H·ªó tr·ª£ JPG, PNG, HEIC. Dung l∆∞·ª£ng &lt; 5MB
                    `;
                }
            });
        }

        // G·ª≠i t·ªõi AI
        if (aiSubmit) {
            aiSubmit.addEventListener('click', async () => {
            const formData = new FormData();
            const file = aiImageInput.files[0];
            const text = aiTextInput.value.trim();

            if (aiMode === 'image' && !file) {
                aiResult.classList.add('visible');
                    aiResult.innerHTML = '<h4>‚ö†Ô∏è Vui l√≤ng ch·ªçn ·∫£nh cu·ªôc tr√≤ chuy·ªán.</h4>';
                return;
            }
            if (aiMode === 'text' && !text) {
                aiResult.classList.add('visible');
                    aiResult.innerHTML = '<h4>‚ö†Ô∏è Vui l√≤ng nh·∫≠p n·ªôi dung vƒÉn b·∫£n.</h4>';
                return;
            }

            if (file) formData.append('image', file);
            if (text) formData.append('raw_text_input', text);

            aiResult.classList.add('visible');
                aiResult.innerHTML = '<h4>‚è≥ ƒêang ph√¢n t√≠ch... (c√≥ th·ªÉ m·∫•t 1-2 ph√∫t)</h4>';

            try {
                // T·∫°o AbortController v·ªõi timeout 120 gi√¢y (2 ph√∫t)
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 120000);
                
                const response = await fetch('/api/v1/image-processing/extract-text', {
                    method: 'POST',
                    body: formData,
                    signal: controller.signal,
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) throw new Error('Kh√¥ng th·ªÉ ph√¢n t√≠ch n·ªôi dung');
                const data = await response.json();
                aiResult.innerHTML = buildAiVerdict(data);
            } catch (error) {
                if (error.name === 'AbortError') {
                    aiResult.innerHTML = '<h4>‚è±Ô∏è H·∫øt th·ªùi gian ch·ªù</h4><p>Server m·∫•t qu√° l√¢u ƒë·ªÉ ph·∫£n h·ªìi. Vui l√≤ng th·ª≠ l·∫°i v·ªõi ·∫£nh nh·ªè h∆°n ho·∫∑c s·ª≠ d·ª•ng ch·ª©c nƒÉng nh·∫≠p text.</p>';
                } else {
                    aiResult.innerHTML = `<h4>‚ùå L·ªói</h4><p>${error.message}</p>`;
                }
            }
        });
        }

        function buildAiVerdict(data) {
            const classification = data.classification;
            if (!classification) {
                return '<h4>‚ö†Ô∏è Ch∆∞a ƒë·ªß d·ªØ li·ªáu ƒë·ªÉ k·∫øt lu·∫≠n.</h4><p>H√£y th·ª≠ l·∫°i v·ªõi n·ªôi dung r√µ h∆°n.</p>';
            }
            if (classification.is_scam) {
                return `
                    <h4>‚ö†Ô∏è C√≥ d·∫•u hi·ªáu l·ª´a ƒë·∫£o</h4>
                    <p><strong>Ch·ªß ƒë·ªÅ:</strong> ${classification.scam_topic || 'Kh√¥ng r√µ'}</p>
                    <p><strong>D·∫•u hi·ªáu:</strong> ${(classification.scam_points || []).join(', ') || 'Ch∆∞a m√¥ t·∫£'}</p>
                    <p><strong>Khuy·∫øn ngh·ªã:</strong> ${classification.recommendations || 'Ng·ª´ng t∆∞∆°ng t√°c, b√°o c√°o t·ªõi SafeNet.'}</p>
                `;
            }
            return `
                <h4>‚úÖ Ch∆∞a c√≥ d·∫•u hi·ªáu l·ª´a ƒë·∫£o</h4>
                <p>${classification.why_not_scam || 'Cu·ªôc tr√≤ chuy·ªán c√≥ v·∫ª b√¨nh th∆∞·ªùng.'}</p>
                <p><strong>L∆∞u √Ω:</strong> Lu√¥n c·∫£nh gi√°c v√† cung c·∫•p th√™m d·ªØ li·ªáu n·∫øu c√≥ d·∫•u hi·ªáu b·∫•t th∆∞·ªùng.</p>
            `;
        }

        // Auth modal logic
        const authBtn = document.getElementById('authBtn');
        const authModal = document.getElementById('authModal');
        const authClose = document.getElementById('authClose');
        const authTabs = document.querySelectorAll('.auth-tab');
        const authForms = document.querySelectorAll('.auth-form');
        const authStatus = document.getElementById('authStatus');
        const registerForm = document.getElementById('registerForm');
        const otpForm = document.getElementById('otpForm');
        const loginForm = document.getElementById('loginForm');
        const otpEmailInput = document.getElementById('otpEmail');

        const showAuthStatus = (message, type = 'success') => {
            if (!authStatus) return;
            authStatus.textContent = message;
            authStatus.className = `auth-status visible ${type}`;
        };

        const switchAuthTab = (tab) => {
            authTabs.forEach((t) => t.classList.toggle('active', t.dataset.authTab === tab));
            authForms.forEach((form) => form.classList.toggle('active', form.id.startsWith(tab)));
            if (authStatus) authStatus.className = 'auth-status';
        };

        if (authBtn) {
            authBtn.addEventListener('click', () => authModal.classList.add('active'));
        }

        if (authClose) {
            authClose.addEventListener('click', () => authModal.classList.remove('active'));
        }

        if (authModal) {
            authModal.addEventListener('click', (e) => {
                if (e.target === authModal) authModal.classList.remove('active');
            });
        }

        authTabs.forEach((tab) => {
            tab.addEventListener('click', () => switchAuthTab(tab.dataset.authTab));
        });

        if (registerForm) {
            registerForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const payload = {
                    email: document.getElementById('registerEmail').value.trim(),
                    password: document.getElementById('registerPassword').value,
                };
                const phone = document.getElementById('registerPhone').value.trim();
                const fullName = document.getElementById('registerName').value.trim();
                if (phone) payload.phone_e164 = phone;
                if (fullName) payload.full_name = fullName;

                try {
                    const res = await fetch('/api/v1/auth/register', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload),
                    });
                    const data = await res.json().catch(() => ({}));
                    if (!res.ok) throw new Error(data.detail || 'Kh√¥ng th·ªÉ ƒëƒÉng k√Ω');
                    showAuthStatus('ƒêƒÉng k√Ω th√†nh c√¥ng! Ki·ªÉm tra email ƒë·ªÉ nh·∫≠n m√£ OTP.', 'success');
                    otpEmailInput.value = payload.email;
                    switchAuthTab('otp');
                } catch (error) {
                    showAuthStatus(error.message, 'error');
                }
            });
        }

        if (otpForm) {
            otpForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const payload = {
                    email: document.getElementById('otpEmail').value.trim(),
                    otp_code: document.getElementById('otpCode').value.trim(),
                };
                try {
                    const res = await fetch('/api/v1/auth/verify-otp', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload),
                    });
                    const data = await res.json().catch(() => ({}));
                    if (!res.ok) throw new Error(data.detail || 'OTP kh√¥ng h·ª£p l·ªá');
                    showAuthStatus('X√°c minh th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p.', 'success');
                    switchAuthTab('login');
                } catch (error) {
                    showAuthStatus(error.message, 'error');
                }
            });
        }

        if (loginForm) {
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const params = new URLSearchParams();
                params.append('username', document.getElementById('loginEmail').value.trim());
                params.append('password', document.getElementById('loginPassword').value);

                try {
                    const res = await fetch('/api/v1/auth/jwt/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: params,
                    });
                    const data = await res.json().catch(() => ({}));
                    if (!res.ok) throw new Error(data.detail || 'ƒêƒÉng nh·∫≠p th·∫•t b·∫°i');
                    localStorage.setItem('safenet_token', data.access_token);
                    showAuthStatus('ƒêƒÉng nh·∫≠p th√†nh c√¥ng! Token ƒë√£ ƒë∆∞·ª£c l∆∞u.', 'success');
                } catch (error) {
                    showAuthStatus(error.message, 'error');
                }
            });
        }

        document.getElementById('year').textContent = new Date().getFullYear();

        // Tin t·ª©c - t√≠nh nƒÉng ch∆∞a ph√°t tri·ªÉn
        const newsLink = document.getElementById('newsLink');
        if (newsLink) {
            newsLink.addEventListener('click', (e) => {
                e.preventDefault();
                alert('üì∞ T√≠nh nƒÉng Tin t·ª©c s·∫Ω s·ªõm ƒë∆∞·ª£c ph√°t tri·ªÉn. Vui l√≤ng quay l·∫°i sau!');
            });
        }

        // Auth Gate Management
        const authGate = document.getElementById('authGate');
        const mainApp = document.getElementById('mainApp');
        const authGateStatus = document.getElementById('authGateStatus');
        const gateTabs = document.querySelectorAll('.auth-gate-tab');
        const gateForms = document.querySelectorAll('.auth-gate-form');
        const logoutBtn = document.getElementById('logoutBtn');

        // Check if user is already logged in
        function checkAuthStatus() {
            const token = localStorage.getItem('access_token');
            if (token) {
                showMainApp();
            } else {
                showAuthGate();
            }
        }

        function showAuthGate() {
            authGate.style.display = 'flex';
            mainApp.style.display = 'none';
        }

        function showMainApp() {
            authGate.style.display = 'none';
            mainApp.style.display = 'block';
            if (logoutBtn) {
                logoutBtn.style.display = 'inline-block';
            }
        }

        function showGateStatus(message, isError = false) {
            authGateStatus.textContent = message;
            authGateStatus.className = `auth-gate-status visible ${isError ? 'error' : 'success'}`;
        }

        function hideGateStatus() {
            authGateStatus.classList.remove('visible');
        }

        // Gate tab switching
        gateTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabType = tab.dataset.gateTab;
                gateTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                gateForms.forEach(form => {
                    form.classList.remove('active');
                    if (form.id === `gate${tabType.charAt(0).toUpperCase() + tabType.slice(1)}Form`) {
                        form.classList.add('active');
                    }
                });
                hideGateStatus();
            });
        });

        // Gate login form
        document.getElementById('gateLoginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('gateLoginEmail').value.trim();
            const password = document.getElementById('gateLoginPassword').value;

            if (!email || !password) {
                showGateStatus('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin', true);
                return;
            }

            try {
                const formData = new FormData();
                formData.append('username', email);
                formData.append('password', password);

                const response = await fetch('/api/v1/auth/jwt/login', {
                    method: 'POST',
                    body: formData,
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.detail || 'ƒêƒÉng nh·∫≠p th·∫•t b·∫°i');
                }

                const data = await response.json();
                localStorage.setItem('access_token', data.access_token);
                showGateStatus('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!');
                setTimeout(showMainApp, 1000);
            } catch (error) {
                showGateStatus(error.message, true);
            }
        });

        // Gate register form
        document.getElementById('gateRegisterForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('gateRegisterEmail').value.trim();
            const password = document.getElementById('gateRegisterPassword').value;
            const fullName = document.getElementById('gateRegisterName').value.trim();

            if (!email || !password) {
                showGateStatus('Vui l√≤ng nh·∫≠p email v√† m·∫≠t kh·∫©u', true);
                return;
            }

            if (password.length < 8) {
                showGateStatus('M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±', true);
                return;
            }

            try {
                const response = await fetch('/api/v1/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email,
                        password,
                        full_name: fullName || null,
                    }),
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.detail || 'ƒêƒÉng k√Ω th·∫•t b·∫°i');
                }

                showGateStatus('ƒêƒÉng k√Ω th√†nh c√¥ng! Vui l√≤ng ki·ªÉm tra email ƒë·ªÉ nh·∫≠n m√£ OTP.');
                document.getElementById('gateOtpEmail').value = email;
                
                // Show OTP form
                gateForms.forEach(form => form.classList.remove('active'));
                document.getElementById('gateOtpForm').style.display = 'flex';
            } catch (error) {
                showGateStatus(error.message, true);
            }
        });

        // Gate OTP form
        document.getElementById('gateOtpForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('gateOtpEmail').value.trim();
            const otpCode = document.getElementById('gateOtpCode').value.trim();

            if (!email || !otpCode) {
                showGateStatus('Vui l√≤ng nh·∫≠p email v√† m√£ OTP', true);
                return;
            }

            try {
                const response = await fetch('/api/v1/auth/verify-otp', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, otp_code: otpCode }),
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.detail || 'X√°c minh OTP th·∫•t b·∫°i');
                }

                showGateStatus('X√°c minh th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ ƒëƒÉng nh·∫≠p ngay.');
                
                // Switch back to login form
                setTimeout(() => {
                    gateTabs.forEach(t => t.classList.remove('active'));
                    gateTabs[0].classList.add('active'); // Login tab
                    gateForms.forEach(form => form.classList.remove('active'));
                    document.getElementById('gateLoginForm').classList.add('active');
                    document.getElementById('gateOtpForm').style.display = 'none';
                    document.getElementById('gateLoginEmail').value = email;
                    hideGateStatus();
                }, 2000);
            } catch (error) {
                showGateStatus(error.message, true);
            }
        });

        // Logout functionality
        if (logoutBtn) {
            logoutBtn.addEventListener('click', () => {
                localStorage.removeItem('access_token');
                showAuthGate();
                logoutBtn.style.display = 'none';
            });
        }

        // Initialize auth check
        checkAuthStatus();
    </script>
</body>
</html>
